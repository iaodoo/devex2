<?xml version="1.0" encoding="utf-8"?>
<odoo>

        <!-- Invoice Form Inheritance -->
        <record id="ia_account_move_form" model="ir.ui.view">
            <field name="name">ia_account_move_form</field>
            <field name="model">account.move</field>
            <field name="inherit_id" ref="account.view_move_form"/>
            <field name="arch" type="xml">
                <button name="button_cancel" position="replace">
                    <button name="button_cancel" string="Cancel Entry" type="object" groups="account.group_account_invoice"
                         context="{'from_form': 'yes'}"     attrs="{'invisible' : ['|', ('id', '=', False), ('state', '!=', 'draft')]}"/>
                </button>
                <button name="button_draft" position="replace">
                        <button name="button_draft" string="Reset to Draft" type="object" groups="account.group_account_invoice"
                           context="{'from_form': 'yes'}"     attrs="{'invisible' : [('show_reset_to_draft_button', '=', False)]}"/>
                </button>
                <!--invoice_line_ids -->
                <xpath expr="//field[@name='invoice_line_ids']/tree/field[@name='analytic_account_id']" position="attributes">
                    <attribute name="invisible">1</attribute>
                    <attribute name="domain">[('tenement_company_id','=',tenement_company_id),('group_id','=',analytic_group_id)]</attribute>
                    <attribute name="options">{'no_create': True}</attribute>
                </xpath>
                <xpath expr="//field[@name='invoice_line_ids']/tree/field[@name='product_id']" position="before">
                    <field name="tenement_company_id" options="{'no_create': True}" required="1"/>
                    <field name="analytic_group_id" options="{'no_create': True}" required="1" domain="[('tenement_company_id','=',tenement_company_id)]"/>
                    <field name="analytic_account_id" string="Tenement" required="1" domain="[('group_id','=',analytic_group_id)]"/>
                    <field name="tenement_state_id" invisible="1"/>
                    <field name="activity_id" required="1" options="{'no_create': True}"/>
                    <field name="tag_id" options="{'no_create': True}"/>
                </xpath>

                <xpath expr="//field[@name='invoice_line_ids']/tree/field[@name='product_id']" position="attributes">
                    <attribute name="required">1</attribute>
                    <attribute name="domain">context.get('default_move_type') in ('out_invoice', 'out_refund', 'out_receipt') and [('sale_ok', '=', True), ('allowed_company_ids', 'in', [tenement_company_id]), ('allowed_state_ids', 'in', [tenement_state_id])] or [('purchase_ok', '=', True), ('allowed_company_ids', 'in', [tenement_company_id]), ('allowed_state_ids', 'in', [tenement_state_id])]</attribute>
                </xpath>
                <xpath expr="//field[@name='invoice_line_ids']/tree/field[@name='name']" position="attributes">
                    <attribute name="string">Description</attribute>
                </xpath>

                <!-- line_ids -->
                <xpath expr="//field[@name='line_ids']/tree/field[@name='analytic_account_id']" position="attributes">
                    <attribute name="invisible">1</attribute>
                    <attribute name="domain">[('tenement_company_id','=',tenement_company_id),('group_id','=',analytic_group_id)]</attribute>
                    <attribute name="options">{'no_create': True}</attribute>
                </xpath>
                <xpath expr="//field[@name='line_ids']/tree/field[@name='account_id']" position="before">
                    <field name="tenement_company_id" options="{'no_create': True}" required="0"/>
                    <field name="analytic_group_id" options="{'no_create': True}" required="0" domain="[('tenement_company_id','=',tenement_company_id)]"/>
                    <field name="analytic_account_id" string="Tenement" required="0" />
                    <field name="tenement_state_id" invisible="1"/>
                    <field name="activity_id" options="{'no_create': True}"/>
                    <field name="tag_id" options="{'no_create': True}"/>
                    <field name="product_id" domain="[('allowed_company_ids', 'in', [tenement_company_id]), ('allowed_state_ids', 'in', [tenement_state_id])]"/>
                </xpath>
                <xpath expr="//field[@name='line_ids']/tree/field[@name='name']" position="attributes">
                    <attribute name="string">Description</attribute>
                </xpath>

            </field>
        </record>

</odoo>
